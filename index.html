<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8">
    <title>AJAX Messaging Project UI 2018</title>
  
    <style>
      html, body {
        height: 100%;
        margin: 0px;
        padding: 0px;
      }
      #controlPanel {
        background-color: #F0F000;
        height: 100%;
        float: left;
      }
      
      #reportArea {
        background-color: #00F0F0;
        height: 100%;
        width: 100%;
        
      }
      .panelTitle {
        padding: 0;
        margin: 0;
        color: red;
        text-align: center;
      }
      
      /*	NOTE: This, combined with the mods to the input[type=text] CSS, make the
        fields of the form all line up on the right border (0px from the right)
      */
      #checkMessagesToPanel, #checkMessagesFromPanel, #newUserPanel, #newMessagePanel {
        border: 2px solid black;
        position: relative;
      }
      
      /*	This, with the relative positioning of the panels (see above) is 
        one way to get the inputs to line up all nicely and flush against
        the right hand side of the panels.
        Position absolute positions elements relative to their nearest
        positioned ancestor so this is putting items 0px from the right 
        hand side of the panel divs...lines them up nicely.
      */
      input[type=text] {
        width: 150px;
        position: absolute;
        right: 0px;
      }
    </style>  </head>
  <body>
    <div id="controlPanel">
		
      <div id="checkMessagesToPanel">
        <p class="panelTitle">Messages To Panel</p>
        <form action="javascript:checkMessagesTo();" method="post">
          To: <input type="text" name="username" placeholder="Username" id="usernameCMT"></input><br>
          <input type="submit"></input>
        </form>
      </div>
      
      <div id="checkMessagesFromPanel">
        <p class="panelTitle">Messages From Panel</p>
        <form action="javascript:checkMessagesFrom();" method="post">
          From: <input type="text" name="username" placeholder="Username" id="usernameCMF"></input><br>
          <input type="submit"></input>
        </form>
      </div>
      
      <div id="newMessagePanel">
        <p class="panelTitle">New Message Panel</p>
        <form action="javascript:newMessage();" method="post">
          From: <input type="text" name="from" placeholder="From" id="fromNM"></input><br>
          To: <input type="text" name="to" placeholder="Recipient(s)" id="toNM"></input><br>
          Body:<br>
          <textarea rows=6 cols=30 name="message" id="messageNM"></textarea><br>
          <input type="submit"></input>
        </form>
      </div>
      
      <div id="newUserPanel">
        <p class="panelTitle">New User Panel</p>
        <form action="javascript:newUser();" method="post">
          Username: <input type="text" name="username" placeholder="Username" id="usernameNU"></input><br>
          Passwyrd: <input type="password" name="password" placeholder="Password" id="passwordNU"></input><br>
          Le'mail: <input type="text" name="email" placeholder="Email" id="emailNU"></input><br>
          <input type="submit"></input>
        </form>
      </div>
    
    </div>
    
    <div id="reportArea">
      This div is where the content from your AJAX requests will show up.
    </div>
  </body>
  <script>
    function sendAjax(url) {
        let xhr = new XMLHttpRequest();

        xhr.onreadystatechange = function() {
            // alert(xhr.responseText);
            if(xhr.readyState == 4 && xhr.status == 200){
                let reportArea = document.getElementById('reportArea');
                reportArea.innerHTML += xhr.responseText;
                
            }
        }

        xhr.open("GET", url, true);

        xhr.send(null);
        
    }

    function checkMessagesTo() {
      username = document.getElementById("usernameCMT").value;
      let url = "checkMessagesTo.php?username=" + username;
      sendAjax(url);
    }
    function checkMessagesFrom() {
      username = document.getElementById("usernameCMF").value;
      let url = "checkMessagesFrom.php?username=" + username;
      sendAjax(url);
    }

    function newMessage() {
      from = document.getElementById("fromNM").value;
      to = document.getElementById("toNM").value;
      message = document.getElementById("messageNM").value;
      let url = "newMessage.php?from=" + from + "?to=" + to + "?message=" + message;
      console.log(url);
      sendAjax(url);
    }

    function newUser() {
      username = document.getElementById("usernameNU").value;
      password = document.getElementById("passwordNU").value;
      email = document.getElementById("emailNU").value;
      let url = "newUser.php?username=" + username + "?password=" + password + "?email=" + email;
      sendAjax(url);

    }

  </script>
</html>